#!/bin/sh
set -e

REDIS_DATA="${REDIS_DATA:-/config/data}"

mkdir -p "$REDIS_DATA" /run/redis

if [ ! -f /config/redis.conf ]; then
    cat > /config/redis.conf << 'EOF'
# Redis configuration for container use
bind 0.0.0.0
port 6379
dir /config/data
dbfilename dump.rdb
appendonly yes
appendfilename "appendonly.aof"
protected-mode no
EOF
fi

chown -R bsd:bsd /config /run/redis
